[
    {
      "type": "function",
      "function": {
        "name": "find_legislation",
        "description": "Searches for official legislation, statutes, or laws using the Exa API. Use for finding the text of a law.",
        "parameters": {
          "type": "object",
          "properties": {
            "query": { "type": "string", "description": "The search query for the legislation." },
            "country_domain_filter": { "type": "string", "description": "Optional 'site:' filter for a government domain (e.g., 'site:legislation.gov.uk')." }
          },
          "required": ["query"]
        }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "find_case_law",
        "description": "Searches for case law and court decisions using the Exa API.",
        "parameters": {
          "type": "object",
          "properties": {
            "query": { "type": "string", "description": "The search query for the case law." },
            "jurisdiction": { "type": "string", "description": "Optional jurisdiction to narrow the search." }
          },
          "required": ["query"]
        }
      }
    },
    {
        "type": "function",
        "function": {
            "name": "get_verbatim_content",
            "description": "Retrieves the full, clean text of web pages from a list of Exa result IDs.",
            "parameters": {
                "type": "object",
                "properties": {
                    "result_ids": { "type": "array", "items": { "type": "string" }, "description": "A list of result IDs from a previous Exa search." }
                },
                "required": ["result_ids"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "find_contact_info",
            "description": "Searches for contact information for a legal institution using the Exa API.",
            "parameters": {
                "type": "object",
                "properties": {
                    "institution_name": { "type": "string", "description": "The name of the institution to find contact info for." }
                },
                "required": ["institution_name"]
            }
        }
    },
    {
      "type": "function",
      "function": {
        "name": "get_party_id_by_name",
        "description": "Looks up the internal partyId for a party mentioned by name within the current case context.",
        "parameters": { "type": "object", "properties": { "case_id": { "type": "string" }, "mentioned_name": { "type": "string" } }, "required": ["case_id", "mentioned_name"] }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "generate_draft_pdf",
        "description": "Takes Markdown content with placeholders, securely substitutes PII, converts to PDF, and stores in Cloud Storage.",
        "parameters": { "type": "object", "properties": { "case_id": { "type": "string" }, "markdown_content": { "type": "string" }, "draft_name": { "type": "string" }, "revision": { "type": "integer" } }, "required": ["case_id", "markdown_content", "draft_name", "revision"] }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "check_quota",
        "description": "Checks if the user has available quota for the specified case tier.",
        "parameters": { "type": "object", "properties": { "user_id": { "type": "string" }, "organization_id": { "type": "string" }, "tier": { "type": "integer" } }, "required": ["user_id", "tier"] }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "get_case_details",
        "description": "Retrieves the entire `case_details` object from Firestore.",
        "parameters": { "type": "object", "properties": { "case_id": { "type": "string" } }, "required": ["case_id"] }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "update_case_details",
        "description": "Updates specific fields within the `case_details` object in Firestore.",
        "parameters": { "type": "object", "properties": { "case_id": { "type": "string" }, "updates": { "type": "object" } }, "required": ["case_id", "updates"] }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "create_support_ticket",
        "description": "Creates a support ticket for unrecoverable errors.",
        "parameters": { "type": "object", "properties": { "case_id": { "type": "string" }, "issue_description": { "type": "string" }, "agent_state_snapshot": { "type": "object" } }, "required": ["case_id", "issue_description"] }
      }
    }
]